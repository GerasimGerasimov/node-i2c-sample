# node-i2c-sample
Из Node.js на девайсе с Debian Linux управляю по I2C светодиодами на плате МБВ.VISUAL на базе микросхем ввода/вывода PCF8574 

Так в Linux oтображаются I2C шины
/dev/i2c-0
/dev/i2c-1

Адреса: 0x20, 0x22, 0x24

Команды на устройства:
0x20, 0x55 включилось 4шт одних светодиодов через один
0x20, 0xAA включилось 4шт других светодиодов через один

1)	I2C имеет два вывода SDA(данные) и SCL(clock). SCL всегда работает на вывод, поэтому PI7 обозначить как 0PI7.
                             i2c1-pins {
                                                           pins = "PI8\0PI7";
                                            function = "i2c1";
                                            phandle = <0x1b???>;
                             };

К «гребёнке» подключен TWI1 который является i2c1 (который не прописан в dts, кроме одной строки i2c1 = "/soc/i2c@5002400", и соответственно описан i2c@5002400):
Все остальные i2c можно задизейблить! 
2)	На плате индикации МБВ, размещены 3шт i2C микросхем ввода/вывода PCF8574 с адресами 0х40, 0х44, 0х48, причём младший бит адреса равен «0» так как в адресе закодирована операция R/W, для ЗАПИСИ (W) младший бит адреса должен быть «0»
3)	Так как светодиоды подключены к +5, и включаются они при подключении вывода PCF8574 к «земле», то в если все биты в байте  «ноль» то светодиоды включатся
4)	Особенностью PCF8574 является то, что хоть выходов в нём 8шт, что соответствует одному байту информации, но передавать надо два байта, при этом:
a.	 первый байт должен быть ИНВЕРСНЫЙ  (где «0» - светит, «1»- не светит),
b.	Второй байт ПРЯМЫМ (где «1» - светит, «0»- не светит)
Почему так - хз

Формат команд:
0x44 (адрес), ИНВЕРСНЫЙ, ПРЯМОЙ
0x48 (адрес), ИНВЕРСНЫЙ, ПРЯМОЙ
0x40 (адрес), ИНВЕРСНЫЙ, ПРЯМОЙ

Чтобы зажечь светодиоды через один: 01010101b = 0x55, 10101010b = 0xAA
Как пример:
0x40, 0x55 , 0xAA – включилось 4шт одних светодиодов через один
0x40, 0xAA , 0x55 – включилось 4шт других светодиодов через один
